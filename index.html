<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Weather App</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body{
  font-family:Poppins,sans-serif;
  min-height:100vh;
  margin:0;
  display:flex;
  justify-content:center;
  background:linear-gradient(135deg,#fceabb,#f8b500);
}
.page-container{
  position:absolute;
  max-width:360px;
  width:90%;
  opacity:0;
  pointer-events:none;
  transform:scale(.97);
  transition:.3s;
}
.page-container.active{
  opacity:1;
  pointer-events:auto;
  transform:scale(1);
}
.input-card{
  background:#fff;
  padding:30px;
  border-radius:20px;
  text-align:center;
  box-shadow:0 15px 30px rgba(0,0,0,.25);
}
#city-input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #ddd;
  margin-bottom:15px;
}
#search-btn{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  font-size:18px;
  color:white;
  background:#ff9966;
  cursor:pointer;
}
h2{color:white;text-align:center}
#weather-icon{display:block;margin:auto;width:100px}
#temperature{
  font-size:72px;
  color:white;
  text-align:center;
}
#feels-like,#description{text-align:center;color:#f1f1f1}

/* AQI */
#aqi-card{
  background:rgba(0,0,0,.35);
  border-radius:15px;
  padding:15px;
  margin:15px 0;
  color:white;
}
.aqi-bar{
  position:relative;
  height:8px;
  border-radius:10px;
  background:linear-gradient(90deg,#1e7f32,#7bc043,#fdd64b,#ff8a3d,#d32f2f);
}
#aqi-dot{
  position:absolute;
  top:50%;
  width:14px;
  height:14px;
  background:white;
  border-radius:50%;
  transform:translate(-50%,-50%);
}

/* GRID */
.data-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
  padding:15px;
  border-radius:12px;
  background:rgba(0,0,0,.35);
}
.data-item span{font-size:12px;color:#ffd966}
.data-item strong{font-size:17px;color:white}

#back-btn{
  margin-top:20px;
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  background:#654321;
  color:white;
  cursor:pointer;
}

/* CHATBOT */
#chatbot{
  position:fixed;
  bottom:20px;
  right:20px;
  width:280px;
  background:#111;
  border-radius:15px;
  color:white;
  overflow:hidden;
  font-size:13px;
}
#chat-header{
  background:#ff9966;
  padding:10px;
  text-align:center;
  font-weight:600;
}
#chat-body{
  max-height:220px;
  overflow-y:auto;
  padding:10px;
}
.chat-msg{margin-bottom:8px}
.user-msg{color:#ffd966}
.bot-msg{color:#90ee90}
#chat-input-area{
  display:flex;
  border-top:1px solid #444;
}
#chat-input{
  flex:1;
  padding:8px;
  border:none;
}
#chat-send{
  background:#ff9966;
  border:none;
  color:white;
  padding:8px 12px;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- INPUT PAGE -->
<div id="input-page" class="page-container active">
  <div class="input-card">
    <h1>Dynamic Weather üå§Ô∏è</h1>
    <input id="city-input" placeholder="Enter city name">
    <button id="search-btn">Show Weather</button>
  </div>
</div>

<!-- DETAILS PAGE -->
<div id="details-page" class="page-container">
  <h2 id="city-name"></h2>
  <img id="weather-icon">
  <div id="temperature"></div>
  <div id="feels-like"></div>
  <div id="description"></div>

  <div id="aqi-card">
    <div id="aqi-title"></div>
    <div id="aqi-message"></div>
    <div class="aqi-bar"><div id="aqi-dot"></div></div>
  </div>

  <div class="data-grid">
    <div class="data-item"><span>HUMIDITY</span><strong id="humidity"></strong></div>
    <div class="data-item"><span>WIND</span><strong id="wind"></strong></div>
    <div class="data-item"><span>PRESSURE</span><strong id="pressure"></strong></div>
    <div class="data-item"><span>VISIBILITY</span><strong id="visibility"></strong></div>
  </div>

  <button id="back-btn">‚Üê New Search</button>
</div>

<!-- CHATBOT -->
<div id="chatbot">
  <div id="chat-header">üå¶Ô∏è Weather Assistant</div>
  <div id="chat-body"></div>
  <div id="chat-input-area">
    <input id="chat-input" placeholder="Ask about clothes, jogging..." />
    <button id="chat-send">‚û§</button>
  </div>
</div>

<script>
const API_KEY="043aa3f3dfcc0cc451d7c3c8d2dab5a2";
const WEATHER_URL="https://api.openweathermap.org/data/2.5/weather";
const AQI_URL="https://api.openweathermap.org/data/2.5/air_pollution";
const ICON_URL="https://openweathermap.org/img/wn/";
const qs=id=>document.getElementById(id);

let currentWeather=null;
let lastAQI=0;

/* WEATHER */
qs("search-btn").onclick=async()=>{
  const city=qs("city-input").value.trim();
  if(!city){alert("Enter city name");return;}

  const res=await fetch(`${WEATHER_URL}?q=${city}&appid=${API_KEY}&units=metric`);
  if(!res.ok){alert("City not found");return;}
  currentWeather=await res.json();

  qs("city-name").textContent=currentWeather.name;
  qs("weather-icon").src=`${ICON_URL}${currentWeather.weather[0].icon}@2x.png`;
  qs("temperature").textContent=Math.round(currentWeather.main.temp)+"¬∞C";
  qs("feels-like").textContent=`Feels like ${Math.round(currentWeather.main.feels_like)}¬∞C`;
  qs("description").textContent=currentWeather.weather[0].description;
  qs("humidity").textContent=currentWeather.main.humidity+"%";
  qs("wind").textContent=currentWeather.wind.speed+" m/s";
  qs("pressure").textContent=currentWeather.main.pressure+" hPa";
  qs("visibility").textContent=(currentWeather.visibility/1000).toFixed(1)+" km";

  const {lat,lon}=currentWeather.coord;
  const aqiRes=await fetch(`${AQI_URL}?lat=${lat}&lon=${lon}&appid=${API_KEY}`);
  const aqiData=await aqiRes.json();
  lastAQI=Math.min(Math.round(aqiData.list[0].components.pm2_5*4),500);

  qs("aqi-title").textContent="AQI "+lastAQI;
  qs("aqi-message").textContent=lastAQI>150?"Poor air quality":"Air quality acceptable";
  qs("aqi-dot").style.left=(lastAQI/500*100)+"%";

  qs("input-page").classList.remove("active");
  qs("details-page").classList.add("active");
};

qs("back-btn").onclick=()=>{
  qs("details-page").classList.remove("active");
  qs("input-page").classList.add("active");
};

/* CHATBOT */
const chatBody=qs("chat-body");
qs("chat-send").onclick=()=>{
  const msg=qs("chat-input").value.trim().toLowerCase();
  if(!msg||!currentWeather) return;

  addMsg("You: "+msg,"user");
  qs("chat-input").value="";

  let reply="Ask about temperature, clothes or jogging.";

  if(msg.includes("temperature")) reply=`Temperature is ${Math.round(currentWeather.main.temp)}¬∞C`;
  else if(msg.includes("clothes")) reply=currentWeather.main.temp>30?"Wear light clothes":"Wear a jacket";
  else if(msg.includes("jog")) reply=lastAQI>150?"Avoid jogging due to AQI":"Jogging is safe";

  addMsg("Bot: "+reply,"bot");
};

function addMsg(text,type){
  const d=document.createElement("div");
  d.className="chat-msg "+(type==="user"?"user-msg":"bot-msg");
  d.textContent=text;
  chatBody.appendChild(d);
  chatBody.scrollTop=chatBody.scrollHeight;
}
</script>

</body>
</html>
